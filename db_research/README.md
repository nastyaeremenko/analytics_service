## Исследование баз данных

### ClickHouse
Тестирование ClickHouse проходило на двух шардах с двумя репликами на каждом.
Таблица вида:

id | 1 | 2 | 3 | 4 | 5 | ...
--- | --- | --- | --- |--- |--- | ---
user_uuid | 0a8e01de-bd11-4194-93dc-26309d641529 | 6df9b337-422e-4c48-ab79-66aed82ae8c7 | 4d334b24-892c-472a-a168-fe2610dfe411 | 9290f795-31be-4eee-bcb5-46e70c8e674f | 078740f9-f811-4e91-b4da-3b6217f37103 | ...
movie_uuid | f4d6d88b-8e28-4f0b-af70-d18d0b9df3f9 | ec8c5f2a-7102-4a95-9b1b-ea1efd380077 | 668a2fbf-b0ab-434d-9bc8-43ad37787166 | 97f23ea5-bb9c-4f5c-a996-3d1c25982665 |577b33ac-376b-4876-97f3-631540df5861 | ...
movie_progress | 71836 |2086 | 16856 | 770 | 44037 | ...
movie_length | 72739 | 2691 | 16856 | 2743 | 55368 | ...
event_time | 2022-05-27 10:02:09 |  2022-05-27 11:30:00 | 2022-05-28 20:52:57 | 2022-05-28 20:52:58 | 2022-05-28 20:52:59 | ...

### Сравнение ClickHouse и Vertica

#### Загрузка данных
- ClickHouse:
  - 35061.02 ms (1 млн)
  - 743004.37 ms (11 млн)
- Vertica:
  - 5573000 ms (1 млн)

#### Подсчет всех записей
- ClickHouse:
  - 69.7 ms (1 млн)
  - 9.26 ms (11 млн)
- Vertica:
  - 24.2 ms (1 млн)

#### Подсчет количества уникальных фильмов
- ClickHouse:
  - 29.9 ms (1 млн)
  - 138 ms (11 млн)
- Vertica:
  - 162 ms (1 млн)

#### Подсчет количества уникальных пользователей
- ClickHouse:
  - 24.4 ms (1 млн)
  - 192 ms (11 млн)
- Vertica:
  - 151 ms (1 млн)

#### Подсчет количества досмотренных до конца фильмов
- ClickHouse:
  - 15.3 ms (1 млн)
  - 59.1 ms (11 млн)
- Vertica:
  - 45.7 ms (1 млн)

### Выводы
Загрузка событий в Vertica медленнее примерно в 159 раз. Скорость получения данных для ClickHouse тоже меньше, чем для Vertica, 11 млн. записей ClickHouse обрабатывается примерно такое же время, как 1 млн. в Vertica.

Так как скорость выполнения SELECT и INSERT являетсют ключевыми показателями для выбора базы данных для системы аналитики, то было принято решение использовать ClickHouse.
